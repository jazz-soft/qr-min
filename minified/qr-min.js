((r,o)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define("QR",[],o):(r=r||window).QR||(r.QR=o())})(this,function(){var C=[[1,1,1,1,1,1,1,0],[1,0,0,0,0,0,1,0],[1,0,1,1,1,0,1,0],[1,0,1,1,1,0,1,0],[1,0,1,1,1,0,1,0],[1,0,0,0,0,0,1,0],[1,1,1,1,1,1,1,0],[0,0,0,0,0,0,0,0]],D=[[1,1,1,1,1],[1,0,0,0,1],[1,0,1,0,1],[1,0,0,0,1],[1,1,1,1,1]],F=[0,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],G=[0,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30];function H(r,o){var t=(5<r[1]?r[1]-1:r[1])%4;o--,t?2==t?r[0]?(r[0]--,r[1]++):7==r[1]?r[1]-=2:r[1]--:r[1]--:r[0]<o?(r[0]++,r[1]++):r[1]?r[1]--:r[1]=o}function J(r){var o,t=(16*r+128)*r+64;return 1<r&&(t-=(25*(o=Math.floor(r/7)+2)-10)*o-55,7<=r)&&(t-=36),Math.floor(t/8)}function K(r){return J(r)-F[r]*G[r]}function L(r){var o=[];if(!(r<2)){o.push(6);for(var t=Math.floor(r/7)+2,f=4*r+10,n=2*Math.floor((8*r+3*t+5)/(4*t-4)),e=0;e<t-1;e++)o.splice(1,0,f),f-=n}return o}function N(r){for(var o=[],t=4*r+17,f=0;f<t;f++)o.push(Array(t).fill(0));return o}function O(r,o){for(var t=0,f=7;0<=f;f--)t=t<<1^285*(t>>>7),t^=(o>>>f&1)*r;return t}return function(r){var o,t;for(r=(new TextEncoder).encode(r),t=1;t<=40&&!(r.length+(t<10?2:3)<=K(t));t++);if(40<t)throw"Input string is too long!";var f=[64];for(10<=t?(f[0]+=r.length>>12,f.push(r.length>>4&255)):f[0]+=r.length>>4,f.push((15&r.length)<<4),a=0;a<r.length;a++)f[f.length-1]+=r[a]>>4,f.push((15&r[a])<<4);for(a=0;f.length<K(t);a++)f.push(1&a?17:236);for(var n=J(t),e=F[t]-n%F[t],h=Math.floor(n/F[t]),l=(r=>{var o,t,f=1,n=Array(r-1).fill(0);for(n.push(1),o=0;o<r;o++){for(t=0;t<n.length;t++)n[t]=O(n[t],f),t+1<n.length&&(n[t]^=n[t+1]);f=O(f,2)}return n})(G[t]),g=0,u=[],a=0;a<e;a++){var i=f.slice(g,g+h-G[t]+(a<h?0:1)),s=((r,o)=>{var t,f,n,e=Array(o.length).fill(0);for(t=0;t<r.length;t++)for(n=r[t]^e.shift(),e.push(0),f=0;f<o.length;f++)e[f]^=O(o[f],n);return e})(i,l);g+=i.length,a<e&&i.push(0),u.push(i.concat(s))}for(f=[],a=0;a<u[0].length;a++)for(o=0;o<u.length;o++)(a!=h-G[t]||e<=o)&&f.push(u[o][a]);var v,p,c,d,M=N(t),y=(r=>{var o,t,f,n,e=4*r+17,h=L(r),l=N(r);for(o=0;o<9;o++)for(t=0;t<9;t++)l[o][t]=1,t&&(l[o][e-t]=1,l[e-t][o]=1);for(o=8;o<e-8;o++)l[o][6]=1,l[6][o]=1;for(f=0;f<h.length;f++)for(n=0;n<h.length;n++)for(o=0;o<5;o++)for(t=0;t<5;t++)!f&&!n||!f&&n==h.length-1||!n&&f==h.length-1||(l[h[f]+o-2][h[n]+t-2]=1);if(6<r)for(o=0;o<6;o++)for(t=0;t<3;t++)l[o][e-t-9]=1,l[e-t-9][o]=1;return l})(t),w=M,n=t,m=4*n+17,x=L(n);for(v=0;v<8;v++)for(p=0;p<8;p++)w[v][p]=C[v][p],w[v][m-p-1]=C[v][p],w[m-v-1][p]=C[v][p];for(p=1,v=8;v<m-8;v++)w[v][6]=p,p=1-(w[6][v]=p);for(c=0;c<x.length;c++)for(d=0;d<x.length;d++)if((c||d)&&(c||d!=x.length-1)&&(d||c!=x.length-1))for(v=0;v<5;v++)for(p=0;p<5;p++)w[x[c]+v-2][x[d]+p-2]=D[v][p];if(w[m-8][8]=1,6<n){for(d=n,c=0;c<12;c++)d=d<<1^7973*(d>>>11);for(d|=n<<12,c=0;c<18;c++)v=m-11+c%3,p=Math.floor(c/3),w[v][p]=(d&1<<c)>>>c,w[p][v]=(d&1<<c)>>>c}var A=[M.length-1,M.length-1];for(a=0;a<f.length;a++)for(o=7;0<=o;o--)for(M[A[0]][A[1]]=(f[a]&1<<o)>>o,H(A,M.length);y[A[0]][A[1]];H(A,M.length));for(a=0;a<8;a++){f=(r=>{var o,t=[];for(o=0;o<r.length;o++)t.push(r[o].slice());return t})(M),I=R=Q=E=j=b=void 0;var Q,R,b=f,j=0,E=a,I=[1,0,3,2][j]<<3|E;for(R=I,Q=0;Q<10;Q++)R=R<<1^1335*(R>>>9);for(I=21522^(I<<10|R),Q=0;Q<6;Q++)b[Q][8]=(I&1<<Q)>>Q;for(b[7][8]=(64&I)>>6,b[8][8]=(128&I)>>7,b[8][7]=(256&I)>>8,Q=9;Q<15;Q++)b[8][14-Q]=(I&1<<Q)>>Q;for(Q=0;Q<8;Q++)b[8][b.length-1-Q]=(I&1<<Q)>>Q;for(Q=8;Q<15;Q++)b[b.length-15+Q][8]=(I&1<<Q)>>Q;k=T=B=z=q=void 0;var T,k,q=f,z=y,B=a;for(T=0;T<q.length;T++)for(k=0;k<q.length;k++)z[T][k]||(B?1==B?T%2:2==B?k%3:3==B?(T+k)%3:4==B?(Math.floor(k/3)+Math.floor(T/2))%2:5==B?T*k%2+T*k%3:6==B?(T*k%2+T*k%3)%2:((T+k)%2+T*k%3)%2:(T+k)%2)||(q[T][k]=1-q[T][k]);o=(r=>{var o,t,f,n,e;for(o=f=0;o<r.length;o++)for(t=0;t<r.length;t++)f+=r[o][t];for(n=r.length*r.length,e=10*Math.floor(Math.abs(n-2*f)/n*10),o=0;o<r.length-1;o++)for(t=0;t<r.length-1;t++)r[o][t]==r[o][t+1]&&r[o][t]==r[o+1][t]&&r[o][t]==r[o+1][t+1]&&(e+=3);for(o=0;o<r.length;o++)for(f=r[o][0],t=n=1;t<r.length;t++)f!=r[o][t]?(f=r[o][t],n=1):(5==++n&&(e+=3),5<n&&e++);for(o=0;o<r.length;o++)for(f=r[0][o],t=n=1;t<r.length;t++)f!=r[t][o]?(f=r[t][o],n=1):(5==++n&&(e+=3),5<n&&e++);for(o=0;o<r.length;o++)for(t=0;t<r.length-6;t++){if(r[o][t]&&!r[o][t+1]&&r[o][t+2]&&r[o][t+3]&&r[o][t+4]&&!r[o][t+5]&&r[o][t+6]){for(f=0;f<4&&!(0<=t-1-f&&r[o][t-1-f]);f++);for(4==f&&(t+7>=r.length||!r[o][t+7])&&(e+=40),f=0;f<4&&!(t+7+f<r.length&&r[o][t+7+f]);f++);4!=f||t&&r[o][t-1]||(e+=40)}if(r[t][o]&&!r[t+1][o]&&r[t+2][o]&&r[t+3][o]&&r[t+4][o]&&!r[t+5][o]&&r[t+6][o]){for(f=0;f<4&&!(0<=t-1-f&&r[t-1-f][o]);f++);for(4==f&&(t+7>=r.length||!r[t+7][o])&&(e+=40),f=0;f<4&&!(t+7+f<r.length&&r[t+7+f][o]);f++);4!=f||t&&r[t-1][o]||(e+=40)}}return e})(f),(!a||o<g)&&(g=o,u=f)}return u}});
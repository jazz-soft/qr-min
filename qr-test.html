<!DOCTYPE html>
<html>
<head>
<title>QR test</title>
<script src="javascript/QR.js"></script>
<style>
#svg { display:inline-block;width: 200px;}
</style>
</head>

<body>
<h1>QR test</h1>

<div><input id="txt"></div>
<h4>SVG:</h4>
<div><span id="svg">svg</span></div>
<h4>Text:</h4>
<div><pre id="pre"></pre></div>

<script>
var txt = document.getElementById('txt');
var svg = document.getElementById('svg');
var pre = document.getElementById('pre');
txt.addEventListener("input", function(evt) { redraw(evt.target.value); });
redraw('https://github.com/jazz-soft/QR');

function redraw(str) {
  var qr = QR(str);
  make_txt(qr);
  make_svg(qr);
}
function make_txt(qr) {
  var i, j, s = '';
  for (i = 0; i < qr.length; i += 2) {
    for (j = 0; j < qr.length; j++) s += i + 1 < qr.length && qr[i + 1][j] ? qr[i][j] ? '█' : '▄' : qr[i][j] ? '▀' : ' ';
    s += '\n';
  }
  pre.innerHTML = s;
}
function make_svg(qr) {
  var w, x = document.createElementNS('http://www.w3.org/2000/svg', "svg");
  x.setAttribute('version', "1.1");
  x.setAttribute('xmlns', "http://www.w3.org/2000/svg");
  x.setAttribute('viewBox', [-2, -2, qr.length + 4, qr.length + 4].join(' '));
  for (i = 0; i < qr.length; i++) for (j = 0; j < qr.length; j++) if (qr[i][j]) {
    w = document.createElementNS('http://www.w3.org/2000/svg', 'rect');
    w.setAttribute('width', 1);
    w.setAttribute('height', 1);
    w.setAttribute('x', j);
    w.setAttribute('y', i);
    x.appendChild(w);
  }
  svg.innerHTML = '';
  svg.appendChild(x);
}
</script>

</body>
</html>